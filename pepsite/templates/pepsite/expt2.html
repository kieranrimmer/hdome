<!DOCTYPE html>
<html lang="en">
  <head>

    {% load staticfiles %}

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png">

    <title>HaploDome - Peptides in Experiment</title>

    <!-- Bootstrap core CSS -->
    <link href="{% static "css/bootstrap.min.css" %}" rel="stylesheet">

		<script src="{% static "js/jquery-2.0.3.min.js" %}">
		</script>
<style>
#cssTable td 
{
    text-align:center; 
    vertical-align:middle;
}
#cssTable th 
{
    text-align:center; 
    vertical-align:middle;
}
</style>


{% load template_filter %}

</head>

<br>

<div class="container">
<div class="jumbotron">
<span class="text-center">

<h1>Peptide complement of Experiment <span class="text-primary">{{expt.title}}</span></h1>

</span>
</div>


    <h2>Peptides detected</h2>

    <table class="table table-striped" id="cssTable">
    <tr><th>Protein</th><th/><th>Peptide</th><th>Modification</th><th>Delta Mass</th><th>Confidence</th><th>Charge State</th><th>Retention Time</th><th>Precursor Mass</th></tr>
    {% for protein in proteins %}
{% query_idestimate ion__experiments=expt peptide__proteins=protein as myides %}
	{% for idestimate in myides %}
        <tr>
	<td>
	<a href="{% url 'pepsite:protein_expts' protein.id %}" class="link">{{protein.name}}</a>
	</td>
	<td>
	<form action="http://www.uniprot.org/uniprot/{{protein.prot_id}}" target="_blank">
        <input class="btn btn-primary" type="submit" value="UniProt entry for {{protein.name}}">
	</form>
	</td>
	<td>
	<a href="{% url 'pepsite:peptide_expts' idestimate.peptide.id %}" class="link">{{idestimate.peptide.sequence}}</a>
	</td>
	<td>
	{{ idestimate.ptm.description }}
	</td>
	<td>
	{{ idestimate.delta_mass }}
	</td>
	<td>
	{{ idestimate.confidence }}
	</td>
	<td>
	{{ idestimate.ion.charge_state }}
	</td>
	<td>
	{{ idestimate.ion.retention_time }}
	</td>
	<td>
	{{ idestimate.ion.precursor_mass }}
	</td>
        </tr>
	{% endfor %}
    {% endfor %}
    </table>

<div class="pagination">
    <span class="step-links">
        {% if proteins.has_previous %}
            <a href="?page={{ proteins.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ proteins.number }} of {{ proteins.paginator.num_pages }}.
        </span>

        {% if proteins.has_next %}
            <a href="?page={{ proteins.next_page_number }}">next</a>
        {% endif %}
    </span>
</div>


<br>

<form action="{% url 'pepsite:send_expt_csv' expt.id %}">
<input class="btn btn-primary" type="submit" value="Download csv">
</form>

<br>

<form action="{% url 'pepsite:allele_search' %}">
<input class="btn btn-warning" type="submit" value="Make another allele search">
</form>

<br>

<form action="{% url 'pepsite:index' %}">
<input class="btn btn-danger" type="submit" value="Return to Haplodome search index">
</form>

<br>

<form action="{% url 'home' %}">
<input class="btn btn-danger" type="submit" value="Return to Haplodome home">
</form>



</div>
</html>
